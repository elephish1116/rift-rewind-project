<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kasper Hsiang - Personal Website</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Â∞èË£úÂº∑ÔºöÁµêÊûúÂç°ÁâáËàáÂçÄÂ°ä */
        .api-row {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            align-items: center;
        }

        .pill {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 999px;
            font-size: 12px;
            background: #eef2ff;
            color: #3730a3;
        }

        .summoner-card,
        .champion-card {
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 12px;
            margin: 8px 0;
        }

        .champions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 10px;
        }

        .lookup-message.success {
            color: #16a34a;
        }

        .lookup-message.error {
            color: #dc2626;
        }

        .mono {
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        }

        pre.api-out {
            background: #0f172a;
            color: #e5e7eb;
            padding: 14px;
            border-radius: 10px;
            overflow: auto;
        }
    </style>
</head>

<body>
    <main>
        <section class="hero">
            <img src="profile-photo.svg" alt="Kasper Hsiang" class="profile-photo">
            <h1>Kasper Hsiang</h1>
            <p class="tagline">Cloud Builder & AWS Enthusiast</p>
            <a href="https://builder.aws.com/community/@elephish" target="_blank" class="aws-link">AWS Builder Center
                Profile</a>
        </section>

        <section class="fun-facts">
            <h3>Fun Facts About Me</h3>
            <div class="facts-grid">
                <div class="fact-card">
                    <h4>üöÄ Challenge In Progress</h4>
                    <p>Currently working on <a
                            href="https://builder.aws.com/content/32eo2kkwuKdMw2Ej2WWgTKRj7yP/pro-deploy-mode-github-amplify-and-modern-development-for-rift-rewind"
                            target="_blank">AWS Builder Challenge #5: GitHub, Amplify, and Modern Development for Rift
                            Rewind!</a></p>
                </div>
                <div class="fact-card">
                    <h4>üéØ Learning Goal</h4>
                    <p>Building my skills one AWS service at a time - S3, CloudFront, and beyond!</p>
                </div>
                <div class="fact-card">
                    <h4>üí° Fun Project</h4>
                    <p>This website is hosted on Amazon S3 with CloudFront for global delivery!</p>
                </div>
            </div>
        </section>

        <section class="aws-journey">
            <h3>AWS Builder Challenge #2</h3>
            <p>I'm currently working on the "Build a website on the cloud" challenge, learning to deploy websites using
                AWS S3 and CloudFront. This site is part of my challenge progress!</p>
            <a href="https://builder.aws.com/content/31C2WxIDSQive7q2Dv5xNFCmYJj/aws-builder-challenge-2-build-a-website-on-the-cloud?trk=86c76c09-e8f4-4138-badc-604ce7bc5d77&sc_channel=el"
                target="_blank" class="cta-button">View Challenge Details</a>
        </section>

        <!-- CONTACT FORM SECTION - Added for user contact functionality -->
        <section class="contact-form">
            <h3>Get In Touch</h3>
            <p>Have a question or want to connect? Send me a message!</p>
            <div id="form-message" class="form-message" style="display: none;"></div>
            <form class="contact-form-container">
                <div class="form-group">
                    <label for="name">Name</label>
                    <input type="text" id="name" name="name" required>
                </div>
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="message">Message</label>
                    <textarea id="message" name="message" rows="5" required></textarea>
                </div>
                <button type="submit" class="contact-submit-btn">Send Message</button>
            </form>
        </section>
        <!-- END CONTACT FORM SECTION -->

        <!-- LEAGUE DATA LOOKUP SECTION -->
        <section class="league-lookup">
            <h3>League Data Lookup</h3>
            <p>Enter a Riot ID to see their level and top champions!</p>
            <div id="lookup-message" class="lookup-message" style="display: none;"></div>

            <div class="lookup-form-container">
                <div class="form-group">
                    <label for="summoner-name">Riot ID</label>
                    <input type="text" id="summoner-name" name="summoner-name"
                        placeholder="GameName#TAG (e.g., Hide on bush#KR1)" required>
                    <small style="color: #687078; display: block; margin-top: 4px;">Format: GameName#TAG</small>
                </div>
                <div class="form-group">
                    <label for="region">Platform</label>
                    <select id="region" name="region">
                        <option value="na1">North America (na1)</option>
                        <option value="euw1">Europe West (euw1)</option>
                        <option value="eun1">Europe Nordic & East (eun1)</option>
                        <option value="kr" selected>Korea (kr)</option>
                        <option value="br1">Brazil (br1)</option>
                        <option value="la1">Latin America North (la1)</option>
                        <option value="la2">Latin America South (la2)</option>
                        <option value="oc1">Oceania (oc1)</option>
                        <option value="tr1">Turkey (tr1)</option>
                        <option value="ru">Russia (ru)</option>
                        <option value="jp1">Japan (jp1)</option>
                    </select>
                </div>
                <button type="button" id="lookup-btn" class="lookup-submit-btn">Look Up Summoner</button>
            </div>

            <!-- Results display area -->
            <div id="summoner-results" class="summoner-results" style="display: none;">
                <h4>Summoner Info <span class="pill mono" id="puuid-pill" style="display:none;"></span></h4>
                <div id="summoner-info"></div>
                <div id="champion-mastery"></div>

                <!-- extra actions -->
                <div style="margin-top:12px;">
                    <div class="api-row">
                        <button id="btn-style">Analyze Style</button>
                        <label>Count</label>
                        <input id="countStyle" type="number" value="20" min="1" max="100" style="width:110px;">
                    </div>
                    <div class="api-row">
                        <button id="btn-sd">Fetch Special Days</button>
                        <label>Count</label>
                        <input id="countSD" type="number" value="50" min="1" max="200" style="width:110px;">
                    </div>
                    <div class="api-row">
                        <button id="btn-ch">Analyze Champions</button>
                        <label>Start</label>
                        <input id="startCh" type="number" value="0" min="0" style="width:110px;">
                        <label>Count</label>
                        <input id="countCh" type="number" value="30" min="1" max="50" style="width:110px;">
                        <button id="btn-ch-more">Load More</button>
                        <span id="pageHint" class="mono" style="font-size:12px;"></span>
                    </div>
                </div>

                <!-- JSON output -->
                <h4 style="margin-top:16px;">API Output</h4>
                <pre id="api-out" class="api-out">{}</pre>
            </div>
        </section>
        <!-- END LEAGUE DATA LOOKUP SECTION -->
    </main>

    <footer>
        <p>&copy; 2025 Kasper Hsiang. Built with ‚ù§Ô∏è on AWS</p>
    </footer>

    <!-- Contact form JavaScript -->
    <script src="script.js"></script>
    <script>
        // === Replace these with your Lambda Function URLs (AuthType=NONE with proper CORS) ===
        const URL_SUMMONER = "https://nf55sobn4zneiw4evs6x7sxjqy0vtgex.lambda-url.us-east-1.on.aws/";
        const URL_STYLE = "https://lf7ndc45w3qazc7pnteazdjm3u0furgj.lambda-url.us-east-1.on.aws/";
        const URL_SD = "https://fie3fo5jsucadrgvoffzwb2jci0nnqme.lambda-url.us-east-1.on.aws/";
        const URL_CH = "https://puvy5gh5fxbhaqgm2p4dl43eee0tfhbp.lambda-url.us-east-1.on.aws/";
        // ================================================================================

        const msg = (text, type = 'success') => {
            const div = document.getElementById('lookup-message');
            div.textContent = text;
            div.className = `lookup-message ${type}`;
            div.style.display = 'block';
            setTimeout(() => div.style.display = 'none', 10000);
        };
        const show = (obj) => {
            document.getElementById('api-out').textContent = JSON.stringify(obj, null, 2);
        };
        const safeFetch = async (url) => {
            const r = await fetch(url);
            const t = await r.text();
            try { return { status: r.status, json: JSON.parse(t) }; }
            catch { return { status: r.status, json: { _raw: t } }; }
        };

        document.addEventListener('DOMContentLoaded', function () {
            const lookupBtn = document.getElementById('lookup-btn');
            const summonerNameInput = document.getElementById('summoner-name');
            const regionSelect = document.getElementById('region');

            const btnStyle = document.getElementById('btn-style');
            const btnSD = document.getElementById('btn-sd');
            const btnCh = document.getElementById('btn-ch');
            const btnChMore = document.getElementById('btn-ch-more');

            let current = { puuid: null, regional: null, nextStart: 0 };

            lookupBtn.addEventListener('click', async function () {
                const summonerName = summonerNameInput.value.trim();
                const platform = regionSelect.value;
                const messageDiv = document.getElementById('lookup-message');
                const resultsDiv = document.getElementById('summoner-results');

                if (!summonerName) return msg('Please enter a Riot ID', 'error');
                if (!summonerName.includes('#')) return msg('Please use Riot ID format: GameName#TAG', 'error');

                lookupBtn.textContent = 'Looking up...';
                lookupBtn.disabled = true;
                messageDiv.style.display = 'none';
                resultsDiv.style.display = 'none';

                try {
                    // GET to your Lambda (Function URL)
                    const url = `${URL_SUMMONER}?riotId=${encodeURIComponent(summonerName)}&platform=${encodeURIComponent(platform)}`;
                    const { status, json } = await safeFetch(url);

                    if (status === 200) {
                        displaySummonerData(json);
                        msg('Summoner found!', 'success');
                        resultsDiv.style.display = 'block';

                        // keep puuid / regional for next calls
                        current.puuid = json?.account?.puuid || null;
                        current.regional = json?.regional || guessRegional(platform);
                        current.nextStart = 0;

                        // show puuid
                        const pill = document.getElementById('puuid-pill');
                        pill.textContent = current.puuid ? `puuid: ${current.puuid}` : '';
                        pill.style.display = current.puuid ? 'inline-block' : 'none';

                        show({ status, ...json });
                    } else {
                        msg(json.error || 'Failed to fetch summoner data', 'error');
                        show({ status, ...json });
                    }
                } catch (e) {
                    console.error(e);
                    msg('Network error. Please try again.', 'error');
                } finally {
                    lookupBtn.textContent = 'Look Up Summoner';
                    lookupBtn.disabled = false;
                }
            });

            // Enter key support
            summonerNameInput.addEventListener('keypress', function (e) { if (e.key === 'Enter') lookupBtn.click(); });

            // Style
            btnStyle.addEventListener('click', async () => {
                const count = document.getElementById('countStyle').value || '20';
                if (!current.puuid) return msg('Please look up a summoner first.', 'error');
                const regional = current.regional || 'asia';
                const url = `${URL_STYLE}?puuid=${encodeURIComponent(current.puuid)}&regional=${encodeURIComponent(regional)}&count=${encodeURIComponent(count)}`;
                const { status, json } = await safeFetch(url);
                show({ status, endpoint: "/style", ...json });
                if (status === 200) msg('Style analyzed.', 'success'); else msg(json.error || 'Style API failed', 'error');
            });

            // Special Days
            btnSD.addEventListener('click', async () => {
                const count = document.getElementById('countSD').value || '50';
                if (!current.puuid) return msg('Please look up a summoner first.', 'error');
                const regional = current.regional || 'asia';
                const url = `${URL_SD}?puuid=${encodeURIComponent(current.puuid)}&regional=${encodeURIComponent(regional)}&count=${encodeURIComponent(count)}`;
                const { status, json } = await safeFetch(url);
                show({ status, endpoint: "/special-days", ...json });
                if (status === 200) {
                    msg(json.partial ? 'Partial special-days (to avoid timeout).' : 'Special days fetched.', 'success');
                } else {
                    msg(json.error || 'Special-days API failed', 'error');
                }
            });

            // Champions (paged)
            btnCh.addEventListener('click', async () => {
                const start = parseInt(document.getElementById('startCh').value || '0', 10) || 0;
                current.nextStart = start;
                await loadChPage(false);
            });
            btnChMore.addEventListener('click', async () => {
                await loadChPage(true);
            });

            async function loadChPage(append) {
                if (!current.puuid) return msg('Please look up a summoner first.', 'error');
                const count = document.getElementById('countCh').value || '30';
                const regional = current.regional || 'asia';
                const url = `${URL_CH}?puuid=${encodeURIComponent(current.puuid)}&regional=${encodeURIComponent(regional)}&start=${current.nextStart}&count=${encodeURIComponent(count)}`;
                const { status, json } = await safeFetch(url);

                const outEl = document.getElementById('api-out');
                if (!append) {
                    show({ status, endpoint: "/champions", ...json });
                } else {
                    try {
                        const prev = JSON.parse(outEl.textContent || "{}");
                        show({ ...prev, appended: json });
                    } catch {
                        show({ status, endpoint: "/champions", ...json });
                    }
                }

                current.nextStart = (json?.nextStart ?? (current.nextStart + Number(count)));
                document.getElementById('pageHint').textContent = `nextStart=${current.nextStart}` + (json?.partial ? " (partial - click Load More)" : "");
                if (status === 200) msg(json.partial ? 'Partial champions (to avoid timeout).' : 'Champions analyzed.', 'success');
                else msg(json.error || 'Champions API failed', 'error');
            }

            // platform ‚Üí regional ÁåúÊ∏¨ÔºàÂæåÁ´ØÂõûÂÇ≥ regional Êõ¥Ê∫ñÔºåÈÄôË£°Âè™ÊòØÂÇôÊè¥Ôºâ
            function guessRegional(platform) {
                const asia = new Set(["kr", "jp1"]);
                const amer = new Set(["na1", "br1", "la1", "la2"]);
                const eu = new Set(["euw1", "eun1", "tr1", "ru"]);
                const sea = new Set(["oc1", "ph2", "sg2", "th2", "tw2", "vn2", "id1"]);
                if (asia.has(platform)) return "asia";
                if (amer.has(platform)) return "americas";
                if (eu.has(platform)) return "europe";
                if (sea.has(platform)) return "sea";
                return "americas";
            }
        });

        function displaySummonerData(data) {
            const resultsDiv = document.getElementById('summoner-results');
            const summonerInfo = document.getElementById('summoner-info');
            const championMastery = document.getElementById('champion-mastery');

            const displayName = data?.summoner?.name || (data?.account ? `${data.account.gameName}#${data.account.tag}` : 'Unknown');

            // Summoner info
            summonerInfo.innerHTML = `
                <div class="summoner-card">
                    <h5>${displayName}</h5>
                    <p>Level: ${data?.summoner?.level ?? '‚Äî'}</p>
                </div>
            `;

            // Top champions
            if (Array.isArray(data.topChampions) && data.topChampions.length > 0) {
                const championsHtml = data.topChampions.map(champ => `
                    <div class="champion-card">
                        <p><strong>Champion ID:</strong> ${champ.championId}</p>
                        <p><strong>Mastery Level:</strong> ${champ.championLevel}</p>
                        <p><strong>Mastery Points:</strong> ${Number(champ.championPoints || 0).toLocaleString()}</p>
                    </div>
                `).join('');
                championMastery.innerHTML = `
                    <h5>Top Champions</h5>
                    <div class="champions-grid">${championsHtml}</div>
                `;
            } else {
                championMastery.innerHTML = '<p>No champion mastery data found.</p>';
            }

            resultsDiv.style.display = 'block';
        }
    </script>
</body>

</html>